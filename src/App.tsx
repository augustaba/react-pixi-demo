/*
 * @Author: Lemon
 * @Date: 2021-07-01 13:34:17
 * @LastEditors: Lemon
 * @LastEditTime: 2021-07-15 15:56:43
 * @FilePath: /react-pixi-my/src/App.tsx
 */
import React, { useCallback, useEffect, useLayoutEffect, useMemo } from 'react'
import { usePixiApp, Text, Sprite, Container } from "@augustaba/react-pixi-fiber"
import { Rectangle, TextStyle, Texture } from 'pixi.js'
import WidthLoading from '@/PureComponents/WithLoading'
import { GameResource, LoadingResource } from '@/utils/resources'
import { ratio, windowHeight, windowWidth } from './utils/common'
import AnimatedSprite from './PureComponents/AnimatedSprite'
import { useResource } from './utils/hooks'
import LoadingBar from './BusinessComponent/Loading/LoadingBar'

export interface AppProps {

}

const loadingBarsSetting = [
  { x: 1, y: 1, w: 457, h: 21 },
  { x: 1, y: 24, w: 457, h: 21 },
  { x: 1, y: 47, w: 457, h: 21 },
  { x: 1, y: 70, w: 457, h: 21 },
  { x: 1, y: 93, w: 457, h: 21 },
  { x: 1, y: 116, w: 457, h: 21 },
  { x: 1, y: 139, w: 457, h: 21 },
  { x: 1, y: 162, w: 457, h: 21 },
  { x: 1, y: 185, w: 457, h: 21 },
  { x: 1, y: 208, w: 457, h: 21 },
  { x: 1, y: 231, w: 457, h: 21 },
  { x: 1, y: 254, w: 457, h: 21 },
  { x: 1, y: 277, w: 457, h: 21 },
  { x: 1, y: 300, w: 457, h: 21 },
  { x: 1, y: 323, w: 457, h: 21 },
  { x: 1, y: 346, w: 457, h: 21 },
  { x: 1, y: 369, w: 457, h: 21 },
  { x: 1, y: 392, w: 457, h: 21 },
  { x: 1, y: 415, w: 457, h: 21 },
  { x: 1, y: 438, w: 457, h: 21 },
  { x: 1, y: 461, w: 457, h: 21 },
  { x: 1, y: 484, w: 457, h: 21 },
  { x: 1, y: 507, w: 457, h: 21 },
  { x: 1, y: 530, w: 457, h: 21 },
  { x: 1, y: 553, w: 457, h: 21 },
  { x: 1, y: 576, w: 457, h: 21 },
  { x: 1, y: 599, w: 457, h: 21 },
  { x: 1, y: 622, w: 457, h: 21 },
  { x: 1, y: 645, w: 457, h: 21 },
  { x: 1, y: 668, w: 457, h: 21 },
  { x: 1, y: 691, w: 457, h: 21 },
  { x: 1, y: 714, w: 457, h: 21 },
  { x: 1, y: 737, w: 457, h: 21 },
  { x: 1, y: 760, w: 457, h: 21 },
  { x: 1, y: 783, w: 457, h: 21 },
  { x: 1, y: 806, w: 457, h: 21 },
  { x: 1, y: 829, w: 457, h: 21 },
  { x: 1, y: 852, w: 457, h: 21 },
  { x: 1, y: 875, w: 457, h: 21 },
  { x: 1, y: 898, w: 457, h: 21 },
  { x: 1, y: 921, w: 457, h: 21 },
  { x: 1, y: 944, w: 457, h: 21 },
  { x: 1, y: 967, w: 457, h: 21 },
  { x: 1, y: 990, w: 457, h: 21 },
  { x: 1, y: 1013, w: 457, h: 21 },
  { x: 1, y: 1036, w: 457, h: 21 },
  { x: 1, y: 1059, w: 457, h: 21 },
  { x: 1, y: 1082, w: 457, h: 21 },
  { x: 1, y: 1105, w: 457, h: 21 },
  { x: 1, y: 1128, w: 457, h: 21 },
  { x: 1, y: 1151, w: 457, h: 21 },
  { x: 1, y: 1174, w: 457, h: 21 },
  { x: 1, y: 1197, w: 457, h: 21 },
  { x: 1, y: 1220, w: 457, h: 21 },
  { x: 1, y: 1243, w: 457, h: 21 },
  { x: 1, y: 1266, w: 457, h: 21 },
  { x: 1, y: 1289, w: 457, h: 21 },
  { x: 1, y: 1312, w: 457, h: 21 },
  { x: 1, y: 1335, w: 457, h: 21 },
  { x: 1, y: 1358, w: 457, h: 21 },
  { x: 1, y: 1381, w: 457, h: 21 },
  { x: 1, y: 1404, w: 457, h: 21 },
  { x: 1, y: 1427, w: 457, h: 21 },
  { x: 1, y: 1450, w: 457, h: 21 },
  { x: 1, y: 1473, w: 457, h: 21 },
  { x: 1, y: 1496, w: 457, h: 21 },
  { x: 1, y: 1519, w: 457, h: 21 },
  { x: 1, y: 1542, w: 457, h: 21 },
  { x: 1, y: 1565, w: 457, h: 21 },
  { x: 1, y: 1588, w: 457, h: 21 },
  { x: 1, y: 1611, w: 457, h: 21 },
  { x: 1, y: 1634, w: 457, h: 21 },
  { x: 1, y: 1657, w: 457, h: 21 },
  { x: 1, y: 1680, w: 457, h: 21 },
  { x: 1, y: 1703, w: 457, h: 21 },
  { x: 1, y: 1726, w: 457, h: 21 },
  { x: 1, y: 1749, w: 457, h: 21 },
  { x: 1, y: 1772, w: 457, h: 21 },
  { x: 1, y: 1795, w: 457, h: 21 },
  { x: 1, y: 1818, w: 457, h: 21 },
  { x: 1, y: 1841, w: 457, h: 21 },
  { x: 1, y: 1864, w: 457, h: 21 },
  { x: 1, y: 1887, w: 457, h: 21 },
  { x: 1, y: 1910, w: 457, h: 21 },
  { x: 1, y: 1933, w: 457, h: 21 },
  { x: 1, y: 1956, w: 457, h: 21 },
  { x: 1, y: 1979, w: 457, h: 21 },
  { x: 1, y: 2002, w: 457, h: 21 },
  { x: 1, y: 2025, w: 457, h: 21 },
  { x: 1, y: 2048, w: 457, h: 21 },
  { x: 1, y: 2071, w: 457, h: 21 },
  { x: 1, y: 2094, w: 457, h: 21 },
  { x: 1, y: 2117, w: 457, h: 21 },
  { x: 1, y: 2140, w: 457, h: 21 },
  { x: 1, y: 2163, w: 457, h: 21 },
  { x: 1, y: 2186, w: 457, h: 21 },
  { x: 1, y: 2209, w: 457, h: 21 },
  { x: 1, y: 2232, w: 457, h: 21 },
  { x: 1, y: 2255, w: 457, h: 21 },
  { x: 1, y: 2278, w: 457, h: 21 },
  { x: 1, y: 2301, w: 457, h: 21 },
  { x: 1, y: 2324, w: 457, h: 21 },
  { x: 1, y: 2347, w: 457, h: 21 },
  { x: 1, y: 2370, w: 457, h: 21 },
  { x: 1, y: 2393, w: 457, h: 21 },
  { x: 1, y: 2416, w: 457, h: 21 },
  { x: 1, y: 2439, w: 457, h: 21 },
  { x: 1, y: 2462, w: 457, h: 21 },
  { x: 1, y: 2485, w: 457, h: 21 },
  { x: 1, y: 2508, w: 457, h: 21 },
  { x: 1, y: 2531, w: 457, h: 21 },
  { x: 1, y: 2554, w: 457, h: 21 },
  { x: 1, y: 2577, w: 457, h: 21 },
  { x: 1, y: 2600, w: 457, h: 21 },
  { x: 1, y: 2623, w: 457, h: 21 },
  { x: 1, y: 2646, w: 457, h: 21 },
  { x: 1, y: 2669, w: 457, h: 21 },
  { x: 1, y: 2692, w: 457, h: 21 },
  { x: 1, y: 2715, w: 457, h: 21 },
  { x: 1, y: 2738, w: 457, h: 21 },
  { x: 1, y: 2761, w: 457, h: 21 },
  { x: 1, y: 2784, w: 457, h: 21 },
  { x: 1, y: 2807, w: 457, h: 21 },
  { x: 1, y: 2830, w: 457, h: 21 },
  { x: 1, y: 2853, w: 457, h: 21 },
  { x: 1, y: 2876, w: 457, h: 21 },
  { x: 1, y: 2899, w: 457, h: 21 },
  { x: 1, y: 2922, w: 457, h: 21 },
  { x: 1, y: 2945, w: 457, h: 21 },
  { x: 1, y: 2968, w: 457, h: 21 },
  { x: 1, y: 2991, w: 457, h: 21 },
  { x: 1, y: 3014, w: 457, h: 21 },
  { x: 1, y: 3037, w: 457, h: 21 },
  { x: 1, y: 3060, w: 457, h: 21 },
  { x: 1, y: 3083, w: 457, h: 21 },
  { x: 1, y: 3106, w: 457, h: 21 },
  { x: 1, y: 3129, w: 457, h: 21 },
  { x: 1, y: 3152, w: 457, h: 21 },
  { x: 1, y: 3175, w: 457, h: 21 },
  { x: 1, y: 3198, w: 457, h: 21 },
  { x: 1, y: 3221, w: 457, h: 21 },
  { x: 1, y: 3244, w: 457, h: 21 },
  { x: 1, y: 3267, w: 457, h: 21 },
  { x: 1, y: 3290, w: 457, h: 21 },
  { x: 1, y: 3313, w: 457, h: 21 },
  { x: 1, y: 3336, w: 457, h: 21 },
  { x: 1, y: 3359, w: 457, h: 21 },
  { x: 1, y: 3382, w: 457, h: 21 },
  { x: 1, y: 3405, w: 457, h: 21 },
  { x: 1, y: 3428, w: 457, h: 21 },
  { x: 1, y: 3451, w: 457, h: 21 },
  { x: 1, y: 3474, w: 457, h: 21 },
  { x: 1, y: 3497, w: 457, h: 21 },
  { x: 1, y: 3520, w: 457, h: 21 },
  { x: 1, y: 3543, w: 457, h: 21 },
  { x: 1, y: 3566, w: 457, h: 21 },
  { x: 1, y: 3589, w: 457, h: 21 },
  { x: 1, y: 3612, w: 457, h: 21 },
  { x: 1, y: 3635, w: 457, h: 21 },
  { x: 1, y: 3658, w: 457, h: 21 },
  { x: 1, y: 3681, w: 457, h: 21 },
  { x: 1, y: 3704, w: 457, h: 21 },
  { x: 1, y: 3727, w: 457, h: 21 },
  { x: 1, y: 3750, w: 457, h: 21 },
  { x: 1, y: 3773, w: 457, h: 21 },
  { x: 1, y: 3796, w: 457, h: 21 },
  { x: 1, y: 3819, w: 457, h: 21 },
  { x: 1, y: 3842, w: 457, h: 21 },
  { x: 1, y: 3865, w: 457, h: 21 },
  { x: 1, y: 3888, w: 457, h: 21 },
  { x: 1, y: 3911, w: 457, h: 21 },
  { x: 1, y: 3934, w: 457, h: 21 },
  { x: 1, y: 3957, w: 457, h: 21 },
  { x: 1, y: 3980, w: 457, h: 21 },
  { x: 1, y: 4003, w: 457, h: 21 },
  { x: 1, y: 4026, w: 457, h: 21 },
  { x: 1, y: 4049, w: 457, h: 21 },
  { x: 1, y: 4072, w: 457, h: 21 },
  { x: 1, y: 4095, w: 457, h: 21 },
  { x: 1, y: 4118, w: 457, h: 21 },
];

const App = props => {
  const { loader } = usePixiApp()
  const { progress, isLoaded } = useResource(GameResource)
  console.log(progress, isLoaded)
  
  return <Container>
    <Sprite name="bg" texture={loader.resources.loadingBg.texture} width={windowWidth} height={windowHeight}></Sprite>
    <Sprite name="topicImg" texture={loader.resources.topicImg.texture} width={windowWidth} height={431*ratio}></Sprite>
    <Sprite name="snowMountain" position={{ x: 0, y: windowHeight }} anchor={{x: 0, y: 1}} texture={loader.resources.snowMountain.texture} width={windowWidth} height={583*ratio}></Sprite>
    <Text text={`加载中...${progress.toFixed(2)}`} />
    <LoadingBar />
  </Container>
}
export default WidthLoading({ resources: LoadingResource })(App)